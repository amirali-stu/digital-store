(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t(require("video.js")):typeof define=="function"&&define.amd?define(["video.js"],t):(n=n||self,n["videojs-http-source-selector"]=t(n.videojs))})(this,function(n){"use strict";function f(n,t){n.prototype=Object.create(t.prototype);n.prototype.constructor=n;n.__proto__=t}function e(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}var u;n=n&&n.hasOwnProperty("default")?n["default"]:n;u="1.1.5";var o=n.getComponent("MenuItem"),s=n.getComponent("Component"),t=function(n){function t(t,i){return i.selectable=!0,i.multiSelectable=!1,n.call(this,t,i)||this}f(t,n);var i=t.prototype;return i.handleClick=function(){var r=this.options_,i,t;for(console.log("Changing quality to:",r.label),n.prototype.handleClick.call(this),i=this.player().qualityLevels(),t=0;t<i.length;t++)i[t].enabled=r.index==i.length?!0:r.index==t?!0:!1},i.update=function(){var n=this.player().qualityLevels().selectedIndex;this.selected(this.options_.index==n)},t}(o);s.registerComponent("SourceMenuItem",t);var i=n.getComponent("MenuButton"),h=function(r){function o(t,u){var o,s,f;if(o=r.call(this,t,u)||this,i.apply(e(o),arguments),s=o.player().qualityLevels(),u&&u["default"])if(u["default"]=="low")for(f=0;f<s.length;f++)s[f].enabled=f==0;else if(u["default"]="high")for(f=0;f<s.length;f++)s[f].enabled=f==s.length-1;o.player().qualityLevels().on(["change","addqualitylevel"],n.bind(e(o),o.update));return o}f(o,r);var u=o.prototype;return u.createEl=function(){return n.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},u.buildCSSClass=function(){return i.prototype.buildCSSClass.call(this)+" vjs-icon-cog"},u.update=function(){return i.prototype.update.call(this)},u.createItems=function(){for(var u=[],n=this.player().qualityLevels(),o=[],f=0;f<n.length;f++){var i=n.length-(f+1),s=i===n.selectedIndex,r=""+i,e=i;(n[i].height?(r=n[i].height+"p",e=parseInt(n[i].height,10)):n[i].bitrate&&(r=Math.floor(n[i].bitrate/1e3)+" kbps",e=parseInt(n[i].bitrate,10)),o.indexOf(r)>=0)||(o.push(r),u.push(new t(this.player_,{label:r,index:i,selected:s,sortVal:e})))}return n.length>1&&u.push(new t(this.player_,{label:"Auto",index:n.length,selected:!1,sortVal:99999})),u.sort(function(n,t){return n.options_.sortVal<t.options_.sortVal?1:n.options_.sortVal>t.options_.sortVal?-1:0}),u},o}(i),c={},l=n.registerPlugin||n.plugin,a=function(t){if(t.addClass("vjs-http-source-selector"),console.log("videojs-http-source-selector initialized!"),console.log("player.techName_:"+t.techName_),t.techName_!="Html5")return!1;t.on(["loadedmetadata"],function(){var u=t.qualityLevels(),i,r;n.log("loadmetadata event");t.videojs_http_source_selector_initialized=="undefined"||t.videojs_http_source_selector_initialized==!0?console.log("player.videojs_http_source_selector_initialized == true"):(console.log("player.videojs_http_source_selector_initialized == false"),t.videojs_http_source_selector_initialized=!0,i=t.controlBar,r=i.getChild("fullscreenToggle").el(),i.el().insertBefore(i.addChild("SourceMenuButton").el(),r))})},r=function(i){var r=this;this.ready(function(){a(r,n.mergeOptions(c,i))});n.registerComponent("SourceMenuButton",h);n.registerComponent("SourceMenuItem",t)};return l("httpSourceSelector",r),r.VERSION=u,r})